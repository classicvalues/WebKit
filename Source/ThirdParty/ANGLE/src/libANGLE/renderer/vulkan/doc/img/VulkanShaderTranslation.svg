<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="1370" height="1152"><source><![CDATA[participant App
participant "ANGLE Front-end"
participant "Vulkan Back-end"
participant "ANGLE Translator"
participant "GlslangWrapperVk"
participant "Glslang"

App->"ANGLE Front-end": glCompileShader (VS)
"ANGLE Front-end"->"Vulkan Back-end": ShaderVk::compile
"Vulkan Back-end"->"ANGLE Translator": sh::Compile
"ANGLE Translator"-->"ANGLE Front-end": return Vulkan-compatible GLSL

Note right of "ANGLE Front-end": Source is using bogus\nVulkan qualifiers to be\ncorrected at link time.

Note right of App: Same for FS, GS, etc...

App->"ANGLE Front-end": glCreateProgram (...)
App->"ANGLE Front-end": glAttachShader (...)
App->"ANGLE Front-end": glLinkProgram
"ANGLE Front-end"->"Vulkan Back-end": ProgramVk::link

Note right of "Vulkan Back-end": ProgramVk inits uniforms,\nlayouts, and descriptors.

"Vulkan Back-end"->GlslangWrapperVk: GlslangWrapperVk::GetShaderSpirvCode
GlslangWrapperVk->Glslang: GlslangToSpv
Glslang-->GlslangWrapperVk: Return SPIR-V

Note right of GlslangWrapperVk: Transform SPIR-V

GlslangWrapperVk-->"Vulkan Back-end": return transformed SPIR-V
"Vulkan Back-end"-->"ANGLE Front-end": return success

Note right of App: App execution continues...

App->"ANGLE Front-end": glDrawArrays (any draw)
"ANGLE Front-end"->"Vulkan Back-end": ContextVk::drawArrays

Note right of "Vulkan Back-end": We init VkShaderModules\nand VkPipeline then\nrecord the draw.

"Vulkan Back-end"-->"ANGLE Front-end": return success
]]></source><desc/><defs><marker id="markerArrowBlock" markerHeight="5" markerWidth="5" orient="auto" refX="5" refY="2.5" viewBox="0 0 5 5"><path d="M 0 0 L 5 2.5 L 0 5 z"/></marker><marker id="markerArrowOpen" markerHeight="16" markerWidth="4" orient="auto" refX="9.6" refY="8" viewBox="0 0 9.6 16"><path d="M 9.6,8 1.92,16 0,13.7 5.76,8 0,2.286 1.92,0 9.6,8 z"/></marker></defs><g class="actor"><rect width="48.906" height="39" x="10" y="20" fill="#fff" stroke="#000" style="stroke-width:2;--darkreader-inline-fill:#eae7e1;--darkreader-inline-stroke:#000000"/><text x="20" y="45" style="font-size:16px;font-family:&quot;Andale Mono&quot;,monospace"><tspan x="20">App</tspan></text></g><g class="actor"><rect width="48.906" height="39" x="10" y="1093.016" fill="#fff" stroke="#000" style="stroke-width:2;--darkreader-inline-fill:#eae7e1;--darkreader-inline-stroke:#000000"/><text x="20" y="1118.016" style="font-size:16px;font-family:&quot;Andale Mono&quot;,monospace"><tspan x="20">App</tspan></text></g><line x1="34.453" x2="34.453" y1="59" y2="1093.016" fill="none" stroke="#000" style="stroke-width:2;--darkreader-inline-fill:none;--darkreader-inline-stroke:#000000"/><g class="actor"><rect width="164.5" height="39" x="252.656" y="20" fill="#fff" stroke="#000" style="stroke-width:2;--darkreader-inline-fill:#eae7e1;--darkreader-inline-stroke:#000000"/><text x="262.656" y="45" style="font-size:16px;font-family:&quot;Andale Mono&quot;,monospace"><tspan x="262.656">ANGLE Front-end</tspan></text></g><g class="actor"><rect width="164.5" height="39" x="252.656" y="1093.016" fill="#fff" stroke="#000" style="stroke-width:2;--darkreader-inline-fill:#eae7e1;--darkreader-inline-stroke:#000000"/><text x="262.656" y="1118.016" style="font-size:16px;font-family:&quot;Andale Mono&quot;,monospace"><tspan x="262.656">ANGLE Front-end</tspan></text></g><line x1="334.906" x2="334.906" y1="59" y2="1093.016" fill="none" stroke="#000" style="stroke-width:2;--darkreader-inline-fill:none;--darkreader-inline-stroke:#000000"/><g class="actor"><rect width="164.5" height="39" x="524.219" y="20" fill="#fff" stroke="#000" style="stroke-width:2;--darkreader-inline-fill:#eae7e1;--darkreader-inline-stroke:#000000"/><text x="534.219" y="45" style="font-size:16px;font-family:&quot;Andale Mono&quot;,monospace"><tspan x="534.219">Vulkan Back-end</tspan></text></g><g class="actor"><rect width="164.5" height="39" x="524.219" y="1093.016" fill="#fff" stroke="#000" style="stroke-width:2;--darkreader-inline-fill:#eae7e1;--darkreader-inline-stroke:#000000"/><text x="534.219" y="1118.016" style="font-size:16px;font-family:&quot;Andale Mono&quot;,monospace"><tspan x="534.219">Vulkan Back-end</tspan></text></g><line x1="606.469" x2="606.469" y1="59" y2="1093.016" fill="none" stroke="#000" style="stroke-width:2;--darkreader-inline-fill:none;--darkreader-inline-stroke:#000000"/><g class="actor"><rect width="174.5" height="39" x="810.047" y="20" fill="#fff" stroke="#000" style="stroke-width:2;--darkreader-inline-fill:#eae7e1;--darkreader-inline-stroke:#000000"/><text x="820.047" y="45" style="font-size:16px;font-family:&quot;Andale Mono&quot;,monospace"><tspan x="820.047">ANGLE Translator</tspan></text></g><g class="actor"><rect width="174.5" height="39" x="810.047" y="1093.016" fill="#fff" stroke="#000" style="stroke-width:2;--darkreader-inline-fill:#eae7e1;--darkreader-inline-stroke:#000000"/><text x="820.047" y="1118.016" style="font-size:16px;font-family:&quot;Andale Mono&quot;,monospace"><tspan x="820.047">ANGLE Translator</tspan></text></g><line x1="897.297" x2="897.297" y1="59" y2="1093.016" fill="none" stroke="#000" style="stroke-width:2;--darkreader-inline-fill:none;--darkreader-inline-stroke:#000000"/><g class="actor"><rect width="174.5" height="39" x="1004.547" y="20" fill="#fff" stroke="#000" style="stroke-width:2;--darkreader-inline-fill:#eae7e1;--darkreader-inline-stroke:#000000"/><text x="1014.547" y="45" style="font-size:16px;font-family:&quot;Andale Mono&quot;,monospace"><tspan x="1014.547">GlslangWrapperVk</tspan></text></g><g class="actor"><rect width="174.5" height="39" x="1004.547" y="1093.016" fill="#fff" stroke="#000" style="stroke-width:2;--darkreader-inline-fill:#eae7e1;--darkreader-inline-stroke:#000000"/><text x="1014.547" y="1118.016" style="font-size:16px;font-family:&quot;Andale Mono&quot;,monospace"><tspan x="1014.547">GlslangWrapperVk</tspan></text></g><line x1="1091.797" x2="1091.797" y1="59" y2="1093.016" fill="none" stroke="#000" style="stroke-width:2;--darkreader-inline-fill:none;--darkreader-inline-stroke:#000000"/><g class="actor"><rect width="87.438" height="39" x="1252.578" y="20" fill="#fff" stroke="#000" style="stroke-width:2;--darkreader-inline-fill:#eae7e1;--darkreader-inline-stroke:#000000"/><text x="1262.578" y="45" style="font-size:16px;font-family:&quot;Andale Mono&quot;,monospace"><tspan x="1262.578">Glslang</tspan></text></g><g class="actor"><rect width="87.438" height="39" x="1252.578" y="1093.016" fill="#fff" stroke="#000" style="stroke-width:2;--darkreader-inline-fill:#eae7e1;--darkreader-inline-stroke:#000000"/><text x="1262.578" y="1118.016" style="font-size:16px;font-family:&quot;Andale Mono&quot;,monospace"><tspan x="1262.578">Glslang</tspan></text></g><line x1="1296.297" x2="1296.297" y1="59" y2="1093.016" fill="none" stroke="#000" style="stroke-width:2;--darkreader-inline-fill:none;--darkreader-inline-stroke:#000000"/><g class="signal"><text x="88.352" y="89.5" style="font-size:16px;font-family:&quot;Andale Mono&quot;,monospace"><tspan x="88.352">glCompileShader (VS)</tspan></text><line x1="34.453" x2="334.906" y1="98" y2="98" fill="none" stroke="#000" style="stroke-width:2;marker-end:url(#markerArrowBlock);--darkreader-inline-fill:none;--darkreader-inline-stroke:#000000"/></g><g class="signal"><text x="388.805" y="128.5" style="font-size:16px;font-family:&quot;Andale Mono&quot;,monospace"><tspan x="388.805">ShaderVk::compile</tspan></text><line x1="334.906" x2="606.469" y1="137" y2="137" fill="none" stroke="#000" style="stroke-width:2;marker-end:url(#markerArrowBlock);--darkreader-inline-fill:none;--darkreader-inline-stroke:#000000"/></g><g class="signal"><text x="698.898" y="167.5" style="font-size:16px;font-family:&quot;Andale Mono&quot;,monospace"><tspan x="698.898">sh::Compile</tspan></text><line x1="606.469" x2="897.297" y1="176" y2="176" fill="none" stroke="#000" style="stroke-width:2;marker-end:url(#markerArrowBlock);--darkreader-inline-fill:none;--darkreader-inline-stroke:#000000"/></g><g class="signal"><text x="476.422" y="206.5" style="font-size:16px;font-family:&quot;Andale Mono&quot;,monospace"><tspan x="476.422">return Vulkan-compatible GLSL</tspan></text><line x1="897.297" x2="334.906" y1="215" y2="215" fill="none" stroke="#000" style="stroke-width:2;stroke-dasharray:6,2;marker-end:url(#markerArrowBlock);--darkreader-inline-fill:none;--darkreader-inline-stroke:#000000"/></g><g class="note"><rect width="231.563" height="67.406" x="354.906" y="235" fill="#fff" stroke="#000" style="stroke-width:2;--darkreader-inline-fill:#eae7e1;--darkreader-inline-stroke:#000000"/><text x="359.906" y="255" style="font-size:16px;font-family:&quot;Andale Mono&quot;,monospace"><tspan x="359.906">Source is using bogus</tspan><tspan x="359.906" dy="1.2em">Vulkan qualifiers to be</tspan><tspan x="359.906" dy="1.2em">corrected at link time.</tspan></text></g><g class="note"><rect width="231.563" height="29" x="54.453" y="322.406" fill="#fff" stroke="#000" style="stroke-width:2;--darkreader-inline-fill:#eae7e1;--darkreader-inline-stroke:#000000"/><text x="59.453" y="342.406" style="font-size:16px;font-family:&quot;Andale Mono&quot;,monospace"><tspan x="59.453">Same for FS, GS, etc...</tspan></text></g><g class="signal"><text x="83.531" y="381.906" style="font-size:16px;font-family:&quot;Andale Mono&quot;,monospace"><tspan x="83.531">glCreateProgram (...)</tspan></text><line x1="34.453" x2="334.906" y1="390.406" y2="390.406" fill="none" stroke="#000" style="stroke-width:2;marker-end:url(#markerArrowBlock);--darkreader-inline-fill:none;--darkreader-inline-stroke:#000000"/></g><g class="signal"><text x="88.352" y="420.906" style="font-size:16px;font-family:&quot;Andale Mono&quot;,monospace"><tspan x="88.352">glAttachShader (...)</tspan></text><line x1="34.453" x2="334.906" y1="429.406" y2="429.406" fill="none" stroke="#000" style="stroke-width:2;marker-end:url(#markerArrowBlock);--darkreader-inline-fill:none;--darkreader-inline-stroke:#000000"/></g><g class="signal"><text x="122.063" y="459.906" style="font-size:16px;font-family:&quot;Andale Mono&quot;,monospace"><tspan x="122.063">glLinkProgram</tspan></text><line x1="34.453" x2="334.906" y1="468.406" y2="468.406" fill="none" stroke="#000" style="stroke-width:2;marker-end:url(#markerArrowBlock);--darkreader-inline-fill:none;--darkreader-inline-stroke:#000000"/></g><g class="signal"><text x="398.258" y="498.906" style="font-size:16px;font-family:&quot;Andale Mono&quot;,monospace"><tspan x="398.258">ProgramVk::link</tspan></text><line x1="334.906" x2="606.469" y1="507.406" y2="507.406" fill="none" stroke="#000" style="stroke-width:2;marker-end:url(#markerArrowBlock);--darkreader-inline-fill:none;--darkreader-inline-stroke:#000000"/></g><g class="note"><rect width="250.828" height="48.203" x="626.469" y="527.406" fill="#fff" stroke="#000" style="stroke-width:2;--darkreader-inline-fill:#eae7e1;--darkreader-inline-stroke:#000000"/><text x="631.469" y="547.406" style="font-size:16px;font-family:&quot;Andale Mono&quot;,monospace"><tspan x="631.469">ProgramVk inits uniforms,</tspan><tspan x="631.469" dy="1.2em">layouts, and descriptors.</tspan></text></g><g class="signal"><text x="675.742" y="606.109" style="font-size:16px;font-family:&quot;Andale Mono&quot;,monospace"><tspan x="675.742">GlslangWrapperVk::GetShaderSpirvCode</tspan></text><line x1="606.469" x2="1091.797" y1="614.609" y2="614.609" fill="none" stroke="#000" style="stroke-width:2;marker-end:url(#markerArrowBlock);--darkreader-inline-fill:none;--darkreader-inline-stroke:#000000"/></g><g class="signal"><text x="1136.25" y="645.109" style="font-size:16px;font-family:&quot;Andale Mono&quot;,monospace"><tspan x="1136.25">GlslangToSpv</tspan></text><line x1="1091.797" x2="1296.297" y1="653.609" y2="653.609" fill="none" stroke="#000" style="stroke-width:2;marker-end:url(#markerArrowBlock);--darkreader-inline-fill:none;--darkreader-inline-stroke:#000000"/></g><g class="signal"><text x="1131.25" y="684.109" style="font-size:16px;font-family:&quot;Andale Mono&quot;,monospace"><tspan x="1131.25">Return SPIR-V</tspan></text><line x1="1296.297" x2="1091.797" y1="692.609" y2="692.609" fill="none" stroke="#000" style="stroke-width:2;stroke-dasharray:6,2;marker-end:url(#markerArrowBlock);--darkreader-inline-fill:none;--darkreader-inline-stroke:#000000"/></g><g class="note"><rect width="164.5" height="29" x="1111.797" y="712.609" fill="#fff" stroke="#000" style="stroke-width:2;--darkreader-inline-fill:#eae7e1;--darkreader-inline-stroke:#000000"/><text x="1116.797" y="732.609" style="font-size:16px;font-family:&quot;Andale Mono&quot;,monospace"><tspan x="1116.797">Transform SPIR-V</tspan></text></g><g class="signal"><text x="728.539" y="772.109" style="font-size:16px;font-family:&quot;Andale Mono&quot;,monospace"><tspan x="728.539">return transformed SPIR-V</tspan></text><line x1="1091.797" x2="606.469" y1="780.609" y2="780.609" fill="none" stroke="#000" style="stroke-width:2;stroke-dasharray:6,2;marker-end:url(#markerArrowBlock);--darkreader-inline-fill:none;--darkreader-inline-stroke:#000000"/></g><g class="signal"><text x="403.258" y="811.109" style="font-size:16px;font-family:&quot;Andale Mono&quot;,monospace"><tspan x="403.258">return success</tspan></text><line x1="606.469" x2="334.906" y1="819.609" y2="819.609" fill="none" stroke="#000" style="stroke-width:2;stroke-dasharray:6,2;marker-end:url(#markerArrowBlock);--darkreader-inline-fill:none;--darkreader-inline-stroke:#000000"/></g><g class="note"><rect width="260.453" height="29" x="54.453" y="839.609" fill="#fff" stroke="#000" style="stroke-width:2;--darkreader-inline-fill:#eae7e1;--darkreader-inline-stroke:#000000"/><text x="59.453" y="859.609" style="font-size:16px;font-family:&quot;Andale Mono&quot;,monospace"><tspan x="59.453">App execution continues...</tspan></text></g><g class="signal"><text x="73.898" y="899.109" style="font-size:16px;font-family:&quot;Andale Mono&quot;,monospace"><tspan x="73.898">glDrawArrays (any draw)</tspan></text><line x1="34.453" x2="334.906" y1="907.609" y2="907.609" fill="none" stroke="#000" style="stroke-width:2;marker-end:url(#markerArrowBlock);--darkreader-inline-fill:none;--darkreader-inline-stroke:#000000"/></g><g class="signal"><text x="369.539" y="938.109" style="font-size:16px;font-family:&quot;Andale Mono&quot;,monospace"><tspan x="369.539">ContextVk::drawArrays</tspan></text><line x1="334.906" x2="606.469" y1="946.609" y2="946.609" fill="none" stroke="#000" style="stroke-width:2;marker-end:url(#markerArrowBlock);--darkreader-inline-fill:none;--darkreader-inline-stroke:#000000"/></g><g class="note"><rect width="231.563" height="67.406" x="626.469" y="966.609" fill="#fff" stroke="#000" style="stroke-width:2;--darkreader-inline-fill:#eae7e1;--darkreader-inline-stroke:#000000"/><text x="631.469" y="986.609" style="font-size:16px;font-family:&quot;Andale Mono&quot;,monospace"><tspan x="631.469">We init VkShaderModules</tspan><tspan x="631.469" dy="1.2em">and VkPipeline then</tspan><tspan x="631.469" dy="1.2em">record the draw.</tspan></text></g><g class="signal"><text x="403.258" y="1064.516" style="font-size:16px;font-family:&quot;Andale Mono&quot;,monospace"><tspan x="403.258">return success</tspan></text><line x1="606.469" x2="334.906" y1="1073.016" y2="1073.016" fill="none" stroke="#000" style="stroke-width:2;stroke-dasharray:6,2;marker-end:url(#markerArrowBlock);--darkreader-inline-fill:none;--darkreader-inline-stroke:#000000"/></g></svg>